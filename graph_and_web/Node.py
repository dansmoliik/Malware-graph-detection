from Edge import Edge


class Node:
    def __init__(self, node_name):
        self.node_name = node_name
        self.edges = {}
        self.parents = []
        self.count = 0

    def __repr__(self):
        return "Node name: {0}".format(self.node_name)

    def get_port_and_protocol(self):
        name_splits = self.node_name.split("-")
        return name_splits[1], name_splits[2]

    def add_new_flow(self, dst_node, flow, index):
        if not (dst_node in self.edges):
            self.edges[dst_node] = Edge(dst_node)
        self.edges[dst_node].add_flow(flow, index)

    def add_connection_from_filtering(self, dst_node_name):
        if not (dst_node_name in self.edges):
            self.edges[dst_node_name] = Edge(dst_node_name)
        self.edges[dst_node_name].add_flow("", -1)

    def add_parent(self, src_node):
        if not (src_node in self.parents):
            self.parents.append(src_node)

    def next_node_name(self, index):
        for node_name in self.edges:
            if self.edges[node_name].has_next_flow(index):
                return node_name
        return None

    def get_neighbours(self):
        return self.edges.keys()

    def increment_count(self):
        self.count += 1
