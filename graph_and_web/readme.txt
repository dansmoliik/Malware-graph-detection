Name

    Graph analysis of malware behaviour

Synopsis

    main.py -p input_file -ip source_ip [OPTIONAL PARAMETER]

Description

    This program can be used to extract features from binetflows file. Written in and for Python2.7.

Mandatory parameters
    -p <input_file>, --path <input_file>
        file you want to process
    -ip <ip_address>
        source IP address you want to examine
Optional parameters
    -f1
        filter nodes with count==1
    -f <args>
        Filter specific protocol, port or port-protocol combination.
        <args> are in following format: [port]-[protocol].
        Use '|' join more protocols or ports.
    -nt <threshold>
        Threshold for node counts (nodes under this threshold won't be used in calculations).
        Default: 0 (if specified threshold is lower, feature is not calculated)
    -slt <threshold>
        Threshold for node auto looping (nodes under this threshold won't be used in calculations).
        Default: 0 (if specified threshold is lower, feature is not calculated)
    -et <threshold>
        Threshold for edge size (edges under this threshold won't be used in calculations).
        Default: 0 (if specified threshold is lower, feature is not calculated)
    -ct <threshold>
        Threshold for cycle count (cycles under this threshold won't be used in calculations).
        Default: 0 (if specified threshold is lower, feature is not calculated)
    -clen <len1>[-<len2>]
        Range of cycle lengths to search for.
        Can be one number, or 2 numbers in format <len1>-<len2>
    -csv
        outputs 2 lines in comma separated values format instead of normal output:
            first line: names of values in second line
            second line: actual values
    --less
        less output to standart output
    --noout
        no output to standard output
    --nooutf
        no output to files
    --gjson
        save created graph in json file
    --label <label>
        label this file (for csv output)
    -h, --help
        display this help


To run on Windows (with Python 2.7 installed):
    python main.py data/2015-04-22_capture-win3.binetflow 10.0.2.103 -f1 -f arp|53,udp -alt 20 -et 10

To see graph in web browser, 
run python server in directory with index.html
with Python2.x
    python -m SimpleHTTPServer 8888 &
with Python3.x
	python -m http.server 8888
and then in browser
    http://localhost:8888/index.html


Some example arguments to run:
    2013-10-21_capture-1.binetflow 147.32.83.53
    2015-03-19_winnormal.binetflow 10.0.2.200
    2015-04-22_capture-win3.binetflow 10.0.2.103
    2016-03-26_win3-capture.binetflow 10.0.2.103
    CTU-Malware-Capture-Botnet-43.binetflow 147.32.84.165 -f1 -alt 20 -et 30 -llen 2-20 -lt 10 --noout

    test1.binetflow 10.0.2.105 # testing purpose only